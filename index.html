<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Original Mixer</title>

    <!-- This mixer is completely useless if you can't auth -->
    <script>
        var NEED_AUTH = 'no_token';

        function getAuthCookie() {
            // token=very_long_string
            // token_type=Bearer
            var components = document.cookie.split(';');

            var cookie = [];
            components.forEach(function(component) {
                component = component.trim();
                // token
                // very_long_string
                var parts = component.split('=');
                cookie[parts[0]] = parts[1];
            });

            if (typeof(cookie['access_token']) !== 'undefined') {
                return cookie['access_token'];
            }
            return NEED_AUTH;
        }

        if (getAuthCookie() === NEED_AUTH) {
            window.location.href = 'login.html';
        }
    </script>

    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <!-- Handlebars -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.10/handlebars.min.js"></script>

    <!-- Libraries -->
    <script src="thirdparty/q.js"></script>
    <script src="thirdparty/spotify-web-api.js"></script>
    <script src="util.js"></script>

    <!-- Mixer base -->
    <script src="playlist.js"></script>
    <script src="track.js"></script>
    <link rel="stylesheet" href="mixer.css">
</head>
<body>
    <div class="content">
        <div id="controls">
            <button id="extend" class="btn btn-success hidden">Find Extended Mixes</button>
            <button id="create-playlist" class="btn btn-primary hidden">Create Extended Playlist</button>
            <a href="#" id="open-playlist" class="btn btn-primary hidden">Open Extended Playlist</a>
        </div>
        <div id="found-radio"></div>
    </div>

    <!-- Templates -->
    <script id="radio-list-template" type="text/x-handlebars-template">
        {{#each tracks}}
        <div class="track" id="track-{{id}}">
            <div class="track-info">
                <img class="album-image" src="{{#album-image 64}}{{/album-image}}" alt="{{album.name}}">
                <span class="track-name">{{name}}</span>
            </div>
            <div class="spacer"></div>
            <div class="radio-version">
                <a class="track-link" href="{{#track-url uri}}{{/track-url}}">Radio</a>
            </div>
            <div class="extended-version loading">
                <span class="preview-text loading">Extended</span>
                <a class="hidden track-link" href="{{#track-url extended-uri}}{{/track-url}}">Extended</a>
            </div>
        </div>
        {{/each}}
    </script>
    <script id="non-radio-list-template" type="text/x-handlebars-template">
        {{#each tracks}}
        <div>{{name}}</div>
        {{/each}}
    </script>

    <!-- Scripts at the end so the DOM exists for them -->
    <script src="mixer.js"></script>
</body>
</html>